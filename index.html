<!DOCTYPE html>
<html>
  <head>
    <title>BBS+ Signatures 2022</title>
    <meta http-equiv='Content-Type' content='text/html;charset=utf-8'/>
    <!--
      === NOTA BENE ===
      For the three scripts below, if your spec resides on dev.w3 you can check them
      out in the same tree and use relative links so that they'll work offline,
     -->
    <script src='https://www.w3.org/Tools/respec/respec-w3c-common' class='remove'></script>
    <script type="text/javascript" class="remove">
      var respecConfig = {
        // specification status (e.g. WD, LCWD, NOTE, etc.). If in doubt use ED.
        specStatus:           "CG-DRAFT",

        // the specification's short name, as in http://www.w3.org/TR/short-name/
        shortName:            "ldp-bbs2022",

        // if you wish the publication date to be other than today, set this
        // publishDate:  "2009-08-06",

        // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
        // and its maturity status
        // previousPublishDate:  "1977-03-15",
        // previousMaturity:  "WD",

        // if there a publicly available Editor's Draft, this is the link
        edDraftURI:           "https://w3c-ccg.github.io/ldp-bbs2022/",

        // if this is a LCWD, uncomment and set the end of its review period
        // lcEnd: "2009-08-05",

        // if you want to have extra CSS, append them to this list
        // it is recommended that the respec.css stylesheet be kept
        //extraCSS:             ["spec.css", "prettify.css"],

        // editors, add as many as you like
        // only "name" is required
        editors:  [
          { name: "Tomislav Markovski", url: "https://trinsic.id/",
            company: "Trinsic", companyURL: "https://trinsic.id/" },
          { name: "Tobias Looker", url: "https://mattr.global/",
            company: "Mattr", companyURL: "https://mattr.global/",
            note: "ldp-bbs2020" },
          { name: "Orie Steele", url: "https://transmute.industries",
            company: "Transmute", companyURL: "https://transmute.industries",
            note: "ldp-bbs2020" }
        ],

        // extend the bibliography entries
        //localBiblio: webpayments.localBiblio,

        wg:           "Credentials Community Group",
        // URI of the public WG page
        wgURI:        "https://www.w3.org/community/credentials/",
        // name (with the @w3c.org) of the public mailing to which comments are due
        wgPublicList: "public-credentials",
        // URI of the patent status for this WG, for Rec-track documents
        // !!!! IMPORTANT !!!!
        // This is important for Rec-track documents, do not copy a patent URI from a random
        // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
        // Team Contact.
        wgPatentURI:  "https://www.w3.org/community/about/agreements/cla/",

        otherLinks: [{
          key: "Source control",
          data: [{
            value: "https://github.com/w3c-ccg/ldp-bbs2020/",
            href: "https://github.com/w3c-ccg/ldp-bbs2020/"
          }]
        }, {
          key: "Issue Tracker",
          data: [{
            value: "https://github.com/w3c-ccg/ldp-bbs2020/issues/",
            href: "https://github.com/w3c-ccg/ldp-bbs2020/issues/"
          }]
        }],

        // URI of the patent status for this WG, for Rec-track documents
        // !!!! IMPORTANT !!!!
        // This is important for Rec-track documents, do not copy a patent URI from a random
        // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
        // Team Contact.
        // wgPatentURI:  "",
        maxTocLevel: 4,
        /*preProcess: [ webpayments.preProcess ],
        alternateFormats: [ {uri: "diff-20111214.html", label: "diff to previous version"} ],
        */
        localBiblio:  {
          "RDF-DATASET-NORMALIZATION": {
            title:    "RDF Dataset Normalization 1.0",
            href:     "http://json-ld.github.io/normalization/spec/",
            authors:  ["David Longley", "Manu Sporny"],
            status:   "CGDRAFT",
            publisher:  "JSON-LD Community Group"
          },
          "RDF-CONCEPTS": {
            title:    "RDF 1.1 Concepts and Abstract Syntax",
            href:     "https://www.w3.org/TR/rdf11-concepts/",
            authors:  ["Richard Cyganiak", "David Wood", "Markus Lanthaler"],
            status:   "Recommendation",
            publisher:  "W3C"
          },
          "RDF-N-Quads": {
            title:    "RDF 1.1 N-Quads",
            href:     "http://json-ld.github.io/normalization/spec/",
            authors:  ["Gaven Carothers"],
            status:   "Recommendation",
          },
          "SECURITY-VOCABULARY": {
            title:    "Security Linked Data Vocabulary",
            href:     "https://web-payments.org/vocabs/security",
            authors:  ["Manu Sporny","David Longley"],
            status:   "CGDRAFT",
            publisher:  "Web Payments Community Group"
          },
          "LD-PROOFS": {
            title:    "Linked Data Proofs 1.0",
            href:     "https://w3c-ccg.github.io/ld-proofs",
            authors:  ["David Longley", "Manu Sporny"],
            status:   "CGDRAFT",
            publisher:  "Web Payments Community Group"
          },
          "JSON-LD-FRAMING": {
            title:    "JSON-LD 1.1 Framing",
            href:     "https://www.w3.org/TR/json-ld11-framing",
            authors:  ["Dave Longley", "Gregg Kellogg", "Pierre-Antoine Champin"],
            status:   "Candidate Recommendation",
            publisher:  "W3C"
          },
          "JSON-LD": {
            title:    "JSON-LD 1.1",
            href:     "https://www.w3.org/TR/json-ld11",
            authors:  ["Dave Longley", "Gregg Kellogg", "Pierre-Antoine Champin"],
            status:   "Candidate Recommendation",
            publisher:  "W3C"
          },
          "PAIRING-FRIENDLY-CURVES": {
            title:    "Pairing-Friendly Curves",
            href:     "https://tools.ietf.org/html/draft-irtf-cfrg-pairing-friendly-curves-03",
            authors:  ["Yumi Sakemi", "Tetsutaro Kobayashi", "Tsunekazu Saito"],
            status:   "Internet Draft",
            publisher:  "IETF"
          },
          "SHORT-GROUP-SIGNATURES": {
            title:    "Short group signatures",
            href:     "https://crypto.stanford.edu/~xb/crypto04a/groupsigs.pdf",
            authors:  ["Dan Boneh", "Xavier Boyen", "Hovav Shacham"],
            status:   "Published",
            publisher:  "Advances in Cryptologyâ€”CRYPTO 2004"
          },
          "BBS": {
            title:    "BBS+ Signatures",
            href:     "https://mattrglobal.github.io/bbs-signatures-spec/",
            authors:  ["Michael Lodder", "Tobias Looker"],
            status:   "Draft"
          },
          "BLAKE2": {
            title:    "Blake2 - fast secure hashing",
            href:     "https://www.blake2.net/",
          }
        }
      };
    </script>
        <style>
          pre .highlight {
            font-weight: bold;
            color: green;
          }
          pre .comment {
            font-weight: bold;
            color: Gray;
          }
          .color-text {
            font-weight: bold;
            text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
          }
          ol.algorithm {
            counter-reset: numsection;
            list-style-type: none;
          }
          ol.algorithm li {
            margin: 0.5em 0;
          }
          ol.algorithm li:before {
            font-weight: bold;
            counter-increment: numsection;
            content: counters(numsection, ".") ") ";
          }
              </style>
  </head>
  <body>
    <section id='abstract'>
      <p>
This specification describes the BBS+ Signature Suite created in 2022
for the Linked Data Proof specification. The Signature Suite utilizes
BBS+ signatures to provide the capability of zero knowledge
proof disclosures.
      </p>
    </section>

    <section id='sotd'>
      <p>
This is an experimental specification and is undergoing regular revisions. It
is not fit for production deployment.
      </p>
    </section>

    <section>
      <h2>Introduction</h2>
      <p>
This specification defines a set of cryptographic suites for the purpose of creating, verifying and deriving proofs
for BBS+ Signatures in conformance with the Linked Data Proofs [[LD-PROOFS]] specification. 
      </p>
      <p>
In general the suites uses <a>canonicalization algorithm</a> to transform an
input document into its canonical form. It then uses the <a>statement digest algorithm</a> 
to digest each statement to be signed individually, finally the digested statements are signed
using the defined <a>signature algorithm</a>.
      </p>
      <p>
BBS+ signatures [[BBS]] are compatible with any pairing friendly elliptic curve, however the cryptographic 
suites defined in this document elect to only allow the usage of the BLS12-381 for interoperability purposes.
      </p>
    </section>

    <section>
      <h2>Terminology</h2>
      <p>
The following terms are used to describe concepts involved in the
generation and verification of the Linked Data Proof
<a>signature suite</a>.
      </p>

      <dl>
        <dt><dfn>signature suite</dfn></dt>
        <dd>
A specified set of cryptographic primitives typically consisting of
a canonicalization algorithm, a message digest algorithm, and a signature
algorithm that are bundled together by cryptographers for developers
for the purposes of safety and convenience.
        </dd>
        <dt><dfn>canonicalization algorithm</dfn></dt>
        <dd>
An algorithm that takes an input document that has more than one possible
representation and always transforms it into a <a>canonical form</a>. This process is
sometimes also called normalization.
        </dd>
        <dt><dfn>canonical form</dfn></dt>
        <dd>
The output of applying a <a>canonicalization algorithm</a> to an input document.
        </dd>
        <dt><dfn>statement</dfn></dt>
        <dd>
<a>n-quads</a> statements are a sequence of RDF terms representing the subject, predicate, object and graph label.
See the grammar definition <a href="https://www.w3.org/TR/n-quads/#grammar-production-statement">here</a>.
        </dd>
        <dt><dfn data-lt="statement digest algorithm | statement digest algorithms">statement digest algorithm</dfn></dt>
        <dd>
An algorithm that takes a <a>statement</a> and produces a cryptographic
output message that is often many orders of magnitude smaller than the
input message. These algorithms are often 1) very fast, 2)
non-reversible, 3) cause the output to change significantly when even one
bit of the input message changes, and 4) make it infeasible to find two
different inputs for the same output.
        </dd>
        <dt><dfn data-lt="statement digest | statement digests">statement digest</dfn></dt>
          <dd>
The result of the application of the <a>statement digest algorithm</a> to a <a>statement</a>
          </dd>
        <dt><dfn>signature algorithm</dfn></dt>
        <dd>
An algorithm that takes an input message and produces an output value where the
receiver of the message can mathematically verify that the message has not
been modified in transit and came from someone possessing a particular secret.
        </dd>
        <dt><dfn>selective disclosure</dfn></dt>
        <dd>
An information disclosure technique which is the process of deciding and disclosing
a sub-set of information from an original information set.
        </dd>
      <dt><dfn>linked data proof document</dfn></dt>
      <dd>
A <a>linked data document</a> featuring one or more <a>linked data proofs</a>.
      </dd>
      <dt><dfn data-lt="revealed statements">revealed statements</dfn></dt>
      <dd>
The set of <a>statements</a> produced by applying the <a>canonicalization algorithm</a> to the <a>reveal document</a>. 
      </dd>
      <dt><dfn>derive proof algorithm</dfn></dt>
      <dd>
An algorithm that takes in a <a>linked data proof document</a> featuring a <a>linked data proof</a> that supports a 
<a>derive proof algorithm</a> along side a <a>reveal document</a> 
and derives a proof only revealing the <a>statement</a>s defined in the <a>reveal document</a>. 
      </dd>
      <dt><dfn>derived proof</dfn></dt>
      <dd>
The product of apply the <a>derive proof algorithm</a> to an <a>linked data proof document</a> and <a>reveal document</a>. 
      </dd>
      <dt><dfn data-lt="quad|quads">quad</dfn></dt>
      <dd>
A <a href="https://json-ld.github.io/normalization/spec/index.html#dfn-quad" class="externalDFN">quad</a> as specified by [[RDF-DATASET-NORMALIZATION]]
      </dd>
      <dt><dfn data-lt="n-quad|n-quads">n-quad</dfn></dt>
      <dd>
An <a href="https://www.w3.org/TR/n-quads/" class="externalDFN">n-quad</a> which is a line based, plain text format encoding of a <a>quad</a> as defined by [[RDF-N-Quads]].
      </dd>
      <dt><dfn data-lt="linked data proof|linked data proofs">linked data proof</dfn></dt>
      <dd>
A <a href="https://w3c-ccg.github.io/ld-proofs/#dfn-linked-data-proof" class="externalDFN">linked data proof</a> 
which is a set of attributes that represent a linked data digital proof and the parameters required to verify it as defined by [[RDF-N-Quads]].
      </dd>
      <dt><dfn data-lt="linked data document|linked data documents">linked data document</dfn></dt>
      <dd>
A document comprised of linked data.
      </dd>
      <dt><dfn data-lt="curve name">curve name</dfn></dt>
      <dd>
The name defining a particular cryptographic curve.
      </dd>
      <dt><dfn data-lt="frame">frame</dfn></dt>
      <dd>
A <a href="https://www.w3.org/TR/json-ld11/#dfn-frame" class="externalDFN">frame</a> as specified by [[JSON-LD-FRAMING]]
is a <a>JSON-LD document</a>, which describes the form for transforming another JSON-LD 
document using matching and embedding rules. A frame document allows additional 
keywords and certain map entries to describe the matching and transforming process.
      </dd>
      <dt><dfn>JSON-LD document</dfn></dt>
      <dd>
A <a href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document" class="externalDFN">JSON-LD document</a> as specified by [[JSON-LD-FRAMING]]
is a is a serialization of an <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a>
      </dd>
      <dt><dfn>framing algorithm</dfn></dt>
      <dd>
A <a href="https://www.w3.org/TR/json-ld11-framing/#framing-algorithm" class="externalDFN">Framing Algorithm</a> as specified by [[JSON-LD-FRAMING]]
is an algorithm that accomplishes the process of framing an input document to a given <a>frame</a>.
      </dd>
      <dt><dfn data-lt="Blank nodes | Blank node">blank node</dfn></dt>
      <dd>
A <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node" class="externalDFN">blank node</a> as specified by [[RDF-CONCEPTS]].
In short, it is a node in a graph that is neither an IRI, nor a literal.
      </dd>
      </dl>
    </section>

    

    <section>
      <h2>BLS12-381</h2>
      <p>
Defined in [[PAIRING-FRIENDLY-CURVES]], BLS12-381 is an elliptic curve that features a unique property 
only present in a subset of elliptic curves known as being pairing friendly.  
      </p>
      <p>
Because of the pairing friendly property, BLS12-381 can be used to construct digital signatures
that have unique properties, such as aggregatable signatures and or signatures
that support zero knowledge proof disclosure.
      </p>
      

<div class="issue">TODO: Is the the below the correct place for the rationale?</div>

      <p>
With pairing friendly elliptic curves, there are two fields, denoted G1 and G2, for 
which signatures and public keys can exist. Importantly however both the public
key and a signature generated using the public key cannot exist in the same field.
      </p>
      <p>
Due to the properties of the two fields, there are different associated performance
characteristics to selecting which field to use for signatures vs which field to use 
for public key generation. In general operations are faster in G1 and the resulting commitments 
are smaller. With this definition of BBS+ signatures we have opted for signatures to be faster
and smaller to create rather than key generation.
      </p>
        
  <section>
    <h3><dfn>Bls 12-381 G1 Public Key</dfn></h3>

    <p>
      The following section defines the representation of the <dfn>Bls12381G1Key2020</dfn>
    </p>

    <p>
      The keys definition MUST have an attribute of <code>publicKeyBase58</code> and its value 
      MUST be a base58 encoded BLS12-381 public key in the G1 field. Where the 
      BLS12-381 public key is the raw 48 byte x co-ordinate defining the commitment. 
    </p>
      <p>
      A simple example of a <a>Bls12381G1Key2020</a>:
      </p>
      <pre class="example highlight" title="base58 encoded BLS12-381 G1 Key">
        {
          "id": "did:example:123#key-0",
          "type": "Bls12381G1Key2020",
          "controller": "did:example:123",
          "publicKeyBase58": "7cJGQwV5XyzUjJEzY5doVhv62Qqou6qW7G4eh9YbUywgyeDCobiXjN8CnQ7wpWBrGR",
        }
      </pre>

      <pre class="example highlight" title="JWK encoded BLS12-381 G1 Key">
        {
          "id": "did:example:123#key-0",
          "type": "Bls12381G1Key2020",
          "controller": "did:example:123",
          "publicKeyJwk": {
            "kty": "EC",
            "crv": "BLS12381_G1",
            "x": "tCgCNuUYQotPEsrljWi-lIRIPpzhqsnJV1NPnE7je6glUb-FJm9IYkuv2hbHw22i"
          }
        }
      </pre>
  </section>

  <section>
    <h3><dfn>Bls 12-381 G2 Public Key</dfn></h3>

    <p>
      The following section defines the representation of the <dfn>Bls12381G2Key2020</dfn>
    </p>

    <p>
      The keys definition MUST have an attribute of <code>publicKeyBase58</code> and its value 
      MUST be a base58 encoded BLS12-381 public key in the G2 field. Where the 
      BLS12-381 public key is the concatenation of the 2 raw 48 byte x co-ordinates
      defining the commitment. 
    </p>
      <p>
      A simple example of a <a>Bls12381G2Key2020</a>:
      </p>
      <pre class="example highlight" title="base58 encoded BLS12-381 G2 Key">
        {
          "id": "did:example:123#key-1",
          "type": "Bls12381G2Key2020",
          "controller": "did:example:123",
          "publicKeyBase58" : "oqpWYKaZD9M1Kbe94BVXpr8WTdFBNZyKv48cziTiQUeuhm7sBhCABMyYG4kcMrseC68YTFFgyhiNeBKjzdKk9MiRWuLv5H4FFujQsQK2KTAtzU8qTBiZqBHMmnLF4PL7Ytu"
        }
      </pre>

      <pre class="example highlight" title="JWK encoded BLS12-381 G2 Key">
        {
          "id": "did:example:123#key-1",
          "type": "Bls12381G2Key2020",
          "controller": "did:example:123",
          "publicKeyJwk": {
            "crv": "BLS12381_G2",
            "kty": "EC",
            "x": "h_rkcTKXXzRbOPr9UxSfegCbid2U_cVNXQUaKeGF7UhwrMJFP70uMH0VQ9-3-_2zDPAAjflsdeLkOXW3-ShktLxuPy8UlXSNgKNmkfb-rrj-FRwbs13pv_WsIf-eV66-"
          }
        }
      </pre>
  </section>
        
    </section>

    
    <section>
      <h2>The BBS+ Signature Suite 2020</h2>

      <p>
        The BBS+ <a>signature suite</a> 2020 MUST be used in
        conjunction with the signing and verification algorithms in the
        Linked Data Proofs [[LD-PROOFS]] specification. The suite consists of
        the following algorithms:
              </p>
        
              <table class="simple">
                <thead>
                  <th>Parameter</th>
                  <th>Value</th>
                  <th>Specification</th>
                </thead>
                <tbody>
                  <tr>
                    <td><a>canonicalization algorithm</a></td>
                    <td>https://w3id.org/security#URDNA2015 or https://w3id.org/security#JPCS</td>
                    <td>[[RDF-DATASET-NORMALIZATION]]</td>
                  </tr>
                  <tr>
                    <td><a>statement digest algorithm</a></td>
                    <td>Blake2b</td>
                    <td>[[BLAKE2]]</td>
                  </tr>
                  <tr>
                    <td><a>signature algorithm</a></td>
                    <td>BBS+ Signature</td>
                    <td>[[BBS]]</td>
                  </tr>
                  <tr>
                    <td><a>curve name</a></td>
                    <td>BLS12-381</td>
                    <td>[[PAIRING-FRIENDLY-CURVES]]</td>
                  </tr>
                </tbody>
              </table>
        
      <section>
        <h3>Modification to Algorithms</h3>

        <section>
          <h4>Create Verify Data Algorithm</h4>

          <p>
            In order to support <a>selective disclosure</a> of <a>statements</a>, 
            the create verify data algorithm has been modified from 
            its original <a href="https://w3c-ccg.github.io/ld-proofs/#create-verify-hash-algorithm"></a>definition</a>.
          </p>

          <p>
          The algorithm defined below, outlines the process of obtaining the data in the form
          required for both signing and verifying.
          </p>

            <ol class="algorithm">
              <li>Canonicalize the input document using the <a>canonicalization algorithm</a> to a set of <a>statements</a> represented as <a>n-quads</a>.</li>
              <li>Initialize an empty array of length equal to the number of statements, let this be known as the <a>statement digests</a> array.</li>
              <li>For each <a>statement</a> in order:
                <ol class="algorithm">
                  <li>Apply the <a>statement digest algorithm</a> to obtain a <a>statement digest</a></li>
                  <li>Insert the <a>statement digest</a> into the <a>statement digests</a> array which MUST maintain same order as the order 
                    of the statements returned from the <a>canonicalization algorithm</a>.</li>
                </ol>
              <li>Returned the <a>statement digests</a> array.</li>
            </ol>

        </section>
        
      </section>

      <section>
        <h3>Terms</h3>
        
        <p>
          The following section outlines the terms used by the BBS+ Signature Suite.
        </p>

        <section>
          <h4>Proof Type</h4>
          
          <p>
            To identify the type of <a>linked data proof</a> that is attached to a <a>linked data document</a>, 
            the <code>type</code> attribute <a href="https://w3c-ccg.github.io/ld-proofs/#linked-data-signatures">defined</a> in
            [[LD-PROOFS]].
          </p>

          <p>
            The term of <code><dfn>BbsBlsSignature2022</dfn></code> is used to indicate when a <a>linked data proof</a> is of type BBS+ Signature.
          </p>

          <p>
            A <a>linked data document</a> featuring a BBS+ Signature </a>linked data proof</a> 
            MUST contain a proof element thats has a type equal to <code>BbsBlsSignature2022</code>.
          </p>


          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "@type": "Person",
              "firstName": "Jane",
              "lastName": "Does",
              "jobTitle": "Professor",
              "telephone": "(425) 123-4567",
              "email": "jane.doe@example.com",
              "proof": {
                <span class="highlight">"type": "BbsBlsSignature2022"</span>,
                "created": "2020-04-25",
                "verificationMethod": "did:example:489398593#test",
                "proofPurpose": "assertionMethod",
                "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
                "requiredRevealStatements": [ 4, 5 ]
              }
            }
          </pre>
        </section>

        <section>
          <h4>Canonicalization Algorithm</h4>
          <p>
            TODO
          </p>
        </section>

        <section>
          <h4>Created</h4>

          <p>
            When a digital signature is produced, it is often useful to capture when this occurred, the <code>created</code> attribute
            can be used to communicate this as <a href="https://w3c-ccg.github.io/ld-proofs/#linked-data-signatures">defined</a> in
            [[LD-PROOFS]].
          </p>

          <p>
            A <a>linked data document</a> featuring a BBS+ Signature </a>linked data proof</a> MAY contain a <code>created</code> 
            attribute with value a value corresponding to an [[!ISO8601]] combined date and time string.
          </p>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "@type": "Person",
              "firstName": "Jane",
              "lastName": "Does",
              "jobTitle": "Professor",
              "telephone": "(425) 123-4567",
              "email": "jane.doe@example.com",
              "proof": {
                "type": "BbsBlsSignature2022",
                <span class="highlight">"created": "2020-04-25"</span>,
                "verificationMethod": "did:example:489398593#test",
                "proofPurpose": "assertionMethod",
                "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
                "requiredRevealStatements": [ 4, 5 ]
              }
            }
          </pre>
        </section>

        <section>
          <h4>@context</h4>

          <p> 
            When using [[JSON-LD]] to exchange data between more than one software system, it's important to use terminology that both of the software systems can understand.
            In [[JSON-LD]] this common terminology is identified with the usage of URIs. However, those URIs can be long and not human friendly for implementors to work with.
            In such cases, aliases that are presented in a short-form can be used to ease this burden. This specification relies on the <code>@context</code> property in [[JSON-LD]]
            to short-form aliases to long form URIs required by this <a>signature suite</a>. It's RECOMMENDED that <code>https://w3id.org/security/bbs/v1</code> is used within the 
            <code>@context</code> property to map the short-form aliases to long form URIs.
          </p>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                <span class="highlight">"https://w3id.org/security/bbs/v1"</span>
              ],
              "@type": "Person",
              "firstName": "Jane",
              "lastName": "Does",
              "jobTitle": "Professor",
              "telephone": "(425) 123-4567",
              "email": "jane.doe@example.com",
              "proof": {
                "type": "BbsBlsSignature2022",
                "created": "2020-04-25",
                "verificationMethod": "did:example:489398593#test",
                "proofPurpose": "assertionMethod",
                "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
                "requiredRevealStatements": [ 4, 5 ]
              }
            }
          </pre>
        </section>

        <section>
          <h4>Verification Method</h4>

          <p>
            When verifying a digital signature, public key material of the signer is required, the <code>verificationMethod</code> attribute is
            used to communicate this as <a href="https://w3c-ccg.github.io/ld-proofs/#linked-data-proof-overview">defined</a> in [[LD-PROOFS]].
          </p>

          <p>
            A <a>linked data document</a> featuring a BBS+ Signature </a>linked data proof</a> MUST contain a <code>verificationMethod</code> 
            attribute with a value that is either the verification method required to verify the </a>linked data proof</a> or a URI that when dereferenced
            results in the verification method required to verify the </a>linked data proof</a>. 
          </p>
          <p>
            The verification method MUST be of <code>type</code> <a>Bls12381G2Key2020</a>.
          </p>

      
          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "@type": "Person",
              "firstName": "Jane",
              "lastName": "Does",
              "jobTitle": "Professor",
              "telephone": "(425) 123-4567",
              "email": "jane.doe@example.com",
              "proof": {
                "type": "BbsBlsSignature2022",
                "created": "2020-04-25",
                <span class="highlight">"verificationMethod": "did:example:489398593#test"</span>,
                "proofPurpose": "assertionMethod",
                "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
                "requiredRevealStatements": [ 4, 5 ]
              }
            }
          </pre>
        </section>

        <section>
          <h4>Proof Purpose</h4>

          <p>
            A proof purpose defines what the purpose of the created proof was and is used to detect whether the verification method
            has been used correctly.
          </p>

          <p>
            A <a>linked data document</a> featuring a BBS+ Signature </a>linked data proof</a> MUST contain a <code>proofPurpose</code> 
            attribute with a value that is <a href="https://w3c-ccg.github.io/ld-proofs/#proof-purpose">defined</a> in [[LD-PROOFS]].
          </p>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "@type": "Person",
              "firstName": "Jane",
              "lastName": "Does",
              "jobTitle": "Professor",
              "telephone": "(425) 123-4567",
              "email": "jane.doe@example.com",
              "proof": {
                "type": "BbsBlsSignature2022",
                "created": "2020-04-25",
                "verificationMethod": "did:example:489398593#test",
                <span class="highlight">"proofPurpose": "assertionMethod"</span>,
                "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
                "requiredRevealStatements": [ 4, 5 ]
              }
            }
          </pre>
        </section>

        <section>
          <h4>Proof Value</h4>

          <p>
            The raw value outputted by computing a sign operation must feature in the proof, in order for parties to verify the signature.
          </p>

          <p>
            A <a>linked data document</a> featuring a BBS+ Signature </a>linked data proof</a> MUST contain a <code>proofValue</code> 
            attribute with value defined by the signing algorithm described in this specification.
          </p>

          <div class="issue">TODO: Define the encoding scheme for the signature value</div>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "@type": "Person",
              "firstName": "Jane",
              "lastName": "Does",
              "jobTitle": "Professor",
              "telephone": "(425) 123-4567",
              "email": "jane.doe@example.com",
              "proof": {
                "type": "BbsBlsSignature2022",
                "created": "2020-04-25",
                "verificationMethod": "did:example:489398593#test",
                "proofPurpose": "assertionMethod",
                <span class="highlight">"proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg=="</span>,
                "requiredRevealStatements": [ 4, 5 ]
              }
            }
          </pre>
        </section>
      </section>
    </section>

    <section>
      <h2>The BBS+ Signature Proof Suite 2020</h2>
      <p>
A BBS proof of knowledge <a>linked data proof</a> is a proof that
is derived from a <a>BbsBlsSignature2022</a> <a>linked data proof</a>
where by a sub-set of the original <a>statements</a> are revealed.
      </p>
      <p>
The BBS+ proof of knowledge <a>signature suite</a> MUST be used in
conjunction with the signing and verification algorithms in the
Linked Data Proofs [[LD-PROOFS]] specification. The suite consists of
the following algorithms:
      </p>
      <table class="simple">
        <thead>
          <th>Parameter</th>
          <th>Value</th>
          <th>Specification</th>
        </thead>
        <tbody>
          <tr>
            <td><a>canonicalization algorithm</a></td>
            <td>https://w3id.org/security#URDNA2015</td>
            <td>[[RDF-DATASET-NORMALIZATION]]</td>
          </tr>
          <tr>
            <td><a>statement digest algorithm</a></td>
            <td>Blake2b</td>
            <td>[[BLAKE2]]</td>
          </tr>
          <tr>
            <td><a>signature algorithm</a></td>
            <td>BBS+ Signature</td>
            <td>[[BBS]]</td>
          </tr>
          <tr>
            <td><a>curve name</a></td>
            <td>BLS12-381</td>
            <td>[[PAIRING-FRIENDLY-CURVES]]</td>
          </tr>
        </tbody>
      </table>

      <section>
        <h3>Terms</h3>
        
        <p>
          The following section outlines the terms used by the BBS+ proof of knowledge <a>signature suite</a>.
        </p>

        <section>
          <h4>Proof Type</h4>

          <p>
            To identify the type of <a>linked data proof</a> that is attached to a <a>linked data document</a>, 
            the <code>type</code> attribute is used as <a href="https://w3c-ccg.github.io/ld-proofs/#linked-data-signatures">defined</a> in
            [[LD-PROOFS]].
          </p>

          <p>
            The term of <code>BbsSignatureProof2020</code> is used to indicate when a <a>linked data proof</a> is of type BBS+ proof of knowledge.
          </p>

          <p>
            A <a>linked data document</a> featuring a BBS+ proof of knowledge </a>linked data proof</a> 
            MUST contain a <code>type</code> attribute thats has a type equal to <code>BbsSignatureProof2020</code>.
          </p>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "id": "urn:bnid:_:c14n0",
              "email": "jane.doe@example.com",
              "firstName": "Jane",
              "jobTitle": "Professor",
              "lastName": "Does",
              "telephone": "(425) 123-4567",
              "proof": {
                <span class="highlight">"type": "BbsBlsSignatureProof2022"</span>,
                "created": "2020-04-25",
                "verificationMethod": "did:example:489398593#test",
                "proofPurpose": "assertionMethod",
                "proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
                "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
              }
            }
          </pre>
        </section>

        <section>
          <h4>Created</h4>

          <div class="issue">TODO: Add paragraph?</div>

          <p>
            A <a>linked data document</a> featuring a BBS+ Signature </a>linked data proof</a> MAY contain a <code>created</code> 
            attribute with value a value corresponding to an [[!ISO8601]] combined date and time string.
          </p>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "id": "urn:bnid:_:c14n0",
              "email": "jane.doe@example.com",
              "firstName": "Jane",
              "jobTitle": "Professor",
              "lastName": "Does",
              "telephone": "(425) 123-4567",
              "proof": {
                "type": "BbsBlsSignatureProof2022",
                <span class="highlight">"created": "2020-04-25"</span>,
                "verificationMethod": "did:example:489398593#test",
                "proofPurpose": "assertionMethod",
                "proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
                "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
              }
            }
          </pre>
        </section>

        <section>
          <h4>Verification Method</h4>

          <p>
            A <a>linked data document</a> featuring a BBS+ proof of knowledge </a>linked data proof</a> MUST contain a <code>verificationMethod</code> 
            attribute with a value that is equal to that of the <a>BbsBlsSignature2022</a> for which the proof is derived from.
          </p>
          
          <div class="issue">TODO: Add paragraph?</div>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "id": "urn:bnid:_:c14n0",
              "email": "jane.doe@example.com",
              "firstName": "Jane",
              "jobTitle": "Professor",
              "lastName": "Does",
              "telephone": "(425) 123-4567",
              "proof": {
                "type": "BbsBlsSignatureProof2022",
                "created": "2020-04-25",
                <span class="highlight">"verificationMethod": "did:example:489398593#test"</span>,
                "proofPurpose": "assertionMethod",
                "proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
                "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
              }
            }
          </pre>
        </section>

        <section>
          <h4>Proof Purpose</h4>

          <div class="issue">TODO: Add paragraph?</div>

          <p>
            A <a>linked data document</a> featuring a BBS+ proof of knowledge </a>linked data proof</a> MUST contain a <code>proofPurpose</code> 
            attribute with a value that is equal to that of the <a>BbsBlsSignature2022</a> for which the proof is derived from.
          </p>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "id": "urn:bnid:_:c14n0",
              "email": "jane.doe@example.com",
              "firstName": "Jane",
              "jobTitle": "Professor",
              "lastName": "Does",
              "telephone": "(425) 123-4567",
              "proof": {
                "type": "BbsBlsSignatureProof2022",
                "created": "2020-04-25",
                "verificationMethod": "did:example:489398593#test",
                <span class="highlight">"proofPurpose": "assertionMethod"</span>,
                "proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
                "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
              }
            }
          </pre>
        </section>

        <section>
          <h4>Proof Value</h4>

          <p>
            The raw value outputted by computing a derive proof operation must feature in the proof, in order for parties to be able to verify the proof.
          </p>

          <p>
            A <a>linked data document</a> featuring a BBS+ proof of knowledge <a>linked data proof</a>
            MUST contain a <code>proofValue</code> attribute with value defined by the derive proof algorithm
            described in this specification.
          </p>


          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "id": "urn:bnid:_:c14n0",
              "email": "jane.doe@example.com",
              "firstName": "Jane",
              "jobTitle": "Professor",
              "lastName": "Does",
              "telephone": "(425) 123-4567",
              "proof": {
                "type": "BbsBlsSignatureProof2022",
                "created": "2020-04-25",
                "verificationMethod": "did:example:489398593#test",
                "proofPurpose": "assertionMethod",
                <span class="highlight">"proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg="</span>,
                "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
              }
            }
          </pre>
        </section>

        <section>
          <h4>Nonce</h4>

          <p>
            When a proof is derived it is often useful to prove to the audience of the proof
            the uniqueness or freshness of proof, the nonce attribute can be used to communicate this.
          </p>

          <p>
            A <a>linked data document</a> featuring a BBS+ proof of knowledge </a>linked data proof</a> 
            MUST contain a <code>nonce</code> attribute.
          </p>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "id": "urn:bnid:_:c14n0",
              "email": "jane.doe@example.com",
              "firstName": "Jane",
              "jobTitle": "Professor",
              "lastName": "Does",
              "telephone": "(425) 123-4567",
              "proof": {
                "type": "BbsBlsSignatureProof2022",
                "created": "2020-04-25",
                "verificationMethod": "did:example:489398593#test",
                "proofPurpose": "assertionMethod",
                "proof": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
                <span class="highlight">"nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="</span>
              }
            }
          </pre>
        </section>
      </section>
    </section>

    <section>
      <h2>The BBS+ Bound Signature Suite 2020</h2>

      <p>
The BBS+ Bound <a>signature suite</a> 2020 adds a mechanism for recipient
binding, and is otherwise identical, to the BBS+ <a>signature suite</a>
2020. It MUST be used in conjunction with the signing and verification
algorithms in the Linked Data Proofs [[LD-PROOFS]] specification. The suite
consists of the following algorithms:
      </p>
      <table class="simple">
        <thead>
        <th>Parameter</th>
        <th>Value</th>
        <th>Specification</th>
        </thead>
        <tbody>
        <tr>
          <td><a>canonicalization algorithm</a></td>
          <td>https://w3id.org/security#URDNA2015</td>
          <td>[[RDF-DATASET-NORMALIZATION]]</td>
        </tr>
        <tr>
          <td><a>statement digest algorithm</a></td>
          <td>Blake2b</td>
          <td>[[BLAKE2]]</td>
        </tr>
        <tr>
          <td><a>signature algorithm</a></td>
          <td>BBS+ Signature</td>
          <td>[[BBS]]</td>
        </tr>
        <tr>
          <td><a>curve name</a></td>
          <td>BLS12-381</td>
          <td>[[PAIRING-FRIENDLY-CURVES]]</td>
        </tr>
        </tbody>
      </table>

      <section>
        <h3>Modification to Algorithms</h3>

        <section>
          <h4>Create Verify Data Algorithm</h4>

          <p>
The create verify data algorithm defined below is identical to the create verify
data algorithm defined for the BBS+ <a>signature suite</a> 2020, with the
addition of steps to include recipient binding.
          </p>

          <p>
The algorithm defined below outlines the process of obtaining the data in the
form required for both signing and verifying, plus the data required to bind to
a recipient
          </p>
          <ol class="algorithm">
            <li>
Obtain a blind message which is a commitment to a secret value as described in
[[BBS]] section 3.9. This is the recipient binding commitment.
            </li>
            <li>
Initialize an empty array of length equal to the number of statements not
including the recipient binding commitment; let this be known as the
<a>statement digests</a> array.
            </li>
            <li>
Use the <a>canonicalization algorithm</a> to canonicalize the input document to a
set of <a>statements</a> represented as <a>n-quads</a>.
            </li>
            <li>
For each <a>statement</a> in order:
              <ol class="algorithm">
                <li>
Apply the <a>statement digest algorithm</a> to obtain a <a>statement digest</a>
                </li>
                <li>
Insert the <a>statement digest</a> into the <a>statement digests</a> array which
MUST maintain same order as the order of the statements returned from the
<a>canonicalization algorithm</a>.
                </li>
              </ol>
            </li>
            <li>
Return the <a>statement digests</a> array and the recipient binding commitment.
            </li>
          </ol>

        </section>

      </section>

      <section>
        <h3>Terms</h3>

        <p>
The following section outlines the terms used by the BBS+ Bound Signature Suite
which differ from those terms used by the BBS+ Signature Suite. All other terms
are the same in both suites.
        </p>

        <section>
          <h4>Proof Type</h4>

          <p>
Use the <code>type</code> attribute
<a href="https://w3c-ccg.github.io/ld-proofs/#linked-data-signatures">defined</a>
in [[LD-PROOFS]] to identify the type of <a>linked data proof</a> that is attached
to a <a>linked data document</a>.
          </p>

          <p>
The term <code><dfn>BbsBlsBoundSignature2020</dfn></code> is used to indicate
when a <a>linked data proof</a> is of type BBS+ Bound Signature.
          </p>

          <p>
A <a>linked data document</a> featuring a BBS+ Bound Signature
<a>linked data proof</a> MUST contain a proof element that has a type equal to
<code>BbsBlsBoundSignature2020</code>.
          </p>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "@type": "Person",
              "firstName": "Jane",
              "lastName": "Does",
              "jobTitle": "Professor",
              "telephone": "(425) 123-4567",
              "email": "jane.doe@example.com",
              "proof": {
                <span class="highlight">"type": "BbsBlsBoundSignature2020"</span>,
                "created": "2020-04-25",
                "verificationMethod": "did:example:489398593#test",
                "proofPurpose": "assertionMethod",
                "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg=="
              }
            }
          </pre>
        </section>
      </section>
    </section>

    <section>
      <h2>The BBS+ Bound Signature Proof Suite 2020</h2>
      <p>
A BBS bound proof of knowledge <a>linked data proof</a> is a proof that is
derived from a <a>BbsBlsBoundSignature2020</a> <a>linked data proof</a> where
a sub-set of the original <a>statements</a> are revealed.
      </p>
      <p>
The BBS+ bound proof of knowledge <a>signature suite</a> MUST be used in
conjunction with the signing and verification algorithms in the Linked Data
Proofs [[LD-PROOFS]] specification. It adds a proof of recipient binding,
and is otherwise identical, to the BBS+ proof of knowledge <a>signature
suite</a>. The suite consists of the following algorithms:
      </p>
      <table class="simple">
        <thead>
          <th>Parameter</th>
          <th>Value</th>
          <th>Specification</th>
        </thead>
        <tbody>
          <tr>
            <td><a>canonicalization algorithm</a></td>
            <td>https://w3id.org/security#URDNA2015</td>
            <td>[[RDF-DATASET-NORMALIZATION]]</td>
          </tr>
          <tr>
            <td><a>statement digest algorithm</a></td>
            <td>Blake2b</td>
            <td>[[BLAKE2]]</td>
          </tr>
          <tr>
            <td><a>signature algorithm</a></td>
            <td>BBS+ Signature</td>
            <td>[[BBS]]</td>
          </tr>
          <tr>
            <td><a>curve name</a></td>
            <td>BLS12-381</td>
            <td>[[PAIRING-FRIENDLY-CURVES]]</td>
          </tr>
        </tbody>
      </table>

      <section>
        <h3>Terms</h3>

        <p>
The following section outlines the terms used by the BBS+ bound proof of
knowledge <a>signature suite</a> which differ from those terms used by the BBS+
proof of knowledge. All other terms are the same in both suites.

        </p>

        <section>
          <h4>Proof Type</h4>

          <p>
The <code>type</code> attribute is used to identify the type of <a>linked
data proof</a> that is attached to a <a>linked data document</a> as <a
href="https://w3c-ccg.github.io/ld-proofs/#linked-data-signatures">defined</a>
in [[LD-PROOFS]].
          </p>

          <p>
The term <code>BbsBoundSignatureProof2020</code> is used to indicate when a
<a>linked data proof</a> is of type BBS+ bound proof of knowledge.
          </p>

          <p>
A <a>linked data document</a> featuring a BBS+ bound proof of knowledge
</a>linked data proof</a> MUST contain a <code>type</code> attribute with a
value of <code>BbsBoundSignatureProof2020</code>.
          </p>

          <pre class="example nohighlight">
            {
              "@context": [
                "http://schema.org/",
                "https://w3id.org/security/v2",
                "https://w3id.org/security/bbs/v1"
              ],
              "id": "urn:bnid:_:c14n0",
              "email": "jane.doe@example.com",
              "firstName": "Jane",
              "jobTitle": "Professor",
              "lastName": "Does",
              "telephone": "(425) 123-4567",
              "proof": {
                <span class="highlight">"type": "BbsBlsBoundSignatureProof2020"</span>,
                "created": "2020-04-25",
                "verificationMethod": "did:example:489398593#test",
                "proofPurpose": "assertionMethod",
                "proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
                "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
              }
            }
          </pre>
        </section>
      </section>
    </section>

    <section>
      <h2>Derive Proof Algorithm</h2>

      <p>
        In order to support <a>selective disclosure</a> of <a>statements</a>, 
        the following <a>derive proof algorithm</a> has been defined.
      </p>

      <div class="issue">TODO: Add examples and full definition of this algorithm</div>

      <section>
        <h4>Create Derive Proof Data Algorithm</h4>
        
        <p>
          The following algorithm defined below outlines the process of obtaining the inputs into the <a>derive proof algorithm</a>.
        </p>

        <dt><dfn>input proof document</dfn></dt>
            <dd>
      A <a>linked data proof document</a> featuring a <a>linked data proof</a> that supports proof derivation.
            </dd>

        <dt><dfn>reveal document</dfn></dt>
            <dd>
      A <a>JSON-LD document</a> in the form of a <a>frame</a> which describes the desired transform to apply to the <a>input proof document</a> using
      the <a>framing algorithm</a> defined in [[JSON-LD-FRAMING]].
            </dd>

        <dt><dfn>revealed document</dfn></dt>
            <dd>
      A <a>linked data proof document</a> which is the product of the <a>derive proof algorithm</a>.
            </dd>

          <ol class="algorithm">
            <li>
              Apply the <a>canonicalization algorithm</a> to the <a>input proof document</a> to obtain a set of <a>statements</a>
              represented as <a>n-quads</a>. Let this set be known as the <dfn>input proof document statements</dfn>.
            </li>
            <li>
              Record the total number of <a>statements</a> in the <a>input proof document statements</a>. 
              Let this be known as the <a>total statements</a>.
            </li>
            <li>
              Apply the <a>framing algorithm</a> to the <a>input proof document</a>. Let the product of the <a>framing algorithm</a> be
              known as the <a>revealed document</a>.
            </li>
            <li>
              Canonicalize the <a>revealed document</a> using the <a>canonicalization algorithm</a> to obtain the set of <a>statements</a> 
              represented as <a>n-quads</a>. Let these be known as the <a>revealed statements</a>.
            </li>
            <li>
              Initialize an empty array of length equal to the number of <a>revealed statements</a>. 
              Let this be known as the <a>revealed indicies</a> array.
            </li>
            <li>For each <a>statement</a> in order:
              <ol class="algorithm">
                <li>Find the numerical index the <a>statement</a> occupies in the set <a>input proof document statements</a>.
                <li>Insert this numerical index into the <a>revealed indicies</a> array</li>
              </ol>
            <li>Returned the <a>revealed indicies</a> array, <a>total statements</a> and <a>input proof document statements</a>.</li>
          </ol>
          <div class="issue">TODO: Define how we have to validate the requiredRevealStatements</div>
          
          <div class="issue">TODO: Add a comment on how we diff the input proof document and the reveal
            document to produce get the correct node identifiers for the reveal document</div>
      </section>

    </section>

    <section id="conformance">

    <div class="issue">TODO: Add paragraph</div>

    </section>

    <section>
      <h2>Security Considerations</h2>
      <p>
The following section describes security considerations that developers
implementing this specification should be aware of in order to create secure
software.
      </p>

<div class="issue">TODO: We need to add a complete list of security
considerations.</div>
    </section>
    <section class="appendix">
      <h2>Acknowledgements</h2>
      <p>
        Portions of the work on this specification have been funded by the
        United States Department of Homeland Security's (US DHS) Silicon Valley
        Innovation Program under contracts 
        70RSAT20T00000003, 
        and
        70RSAT20T00000033.
        The content of this specification does not
        necessarily reflect the position or the policy of the U.S. Government
        and no official endorsement should be inferred.
      </p>
    </section>
  </body>
</html>
